#!/bin/sh
#
# pick recent file
#
# requires:
# - fzf (https://github.com/junegunn/fzf)
# - bat (change to your liking) (https://github.com/sharkdp/bat)
#
# for this to work, add the following in kakrc:
# (requires sponge from moreutils: https://joeyh.name/code/moreutils/)
# hook global BufCreate [^*].* %{
#     nop %sh{
#         mru=~/.cache/kak-mru
#         echo "$kak_buffile" | awk '!seen[$0]++' - "$mru" | sponge "$mru"
#     }
# }

preview_cmd="bat --color=always --line-range=:500"
pwd=$(echo $PWD | sed 's|/|-|g')
mru=~/.cache/kak-mru-"$pwd"


[ ! -f "$mru" ] && touch "$mru"

selected=$(fzf --height 100% --prompt 'mru> ' --preview "$preview_cmd {}" < "${mru}")
if [ -n "$selected" ]; then
	kks edit "${selected}"
fi
